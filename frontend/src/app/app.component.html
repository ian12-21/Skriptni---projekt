<div class="container">
  <header>
    <h1>{{ title }}</h1>
    <p>Sustav za dohvaÄ‡anje, obradu i prikaz podataka s dnevnom rotacijom</p>
    
    <!-- Harvester Status -->
    <div class="harvester-status" *ngIf="harvesterStatus">
      <span class="status-badge" [class.active]="harvesterStatus.running">
        {{ harvesterStatus.running ? 'ğŸŸ¢ Harvester aktivan' : 'ğŸ”´ Harvester neaktivan' }}
      </span>
      <span class="status-info" *ngIf="harvesterStatus.lastRun">
        Zadnje dohvaÄ‡anje: {{ formatDate(harvesterStatus.lastRun) }}
      </span>
      <span class="status-info" *ngIf="harvesterStatus.nextRun">
        SljedeÄ‡e: {{ formatDate(harvesterStatus.nextRun) }}
      </span>
      <span class="status-info">
        Interval: {{ formatInterval(harvesterStatus.interval) }}
      </span>
    </div>
  </header>

  <div class="controls">
    <div class="button-group">
      <button class="btn-primary" (click)="triggerHarvest()" [disabled]="loading">
        {{ loading ? 'DohvaÄ‡am...' : 'ğŸ”„ RuÄno DohvaÄ‡anje' }}
      </button>
      <button class="btn-secondary" (click)="loadData()" [disabled]="loading">
        ğŸ“Š PrikaÅ¾i Podatke
      </button>
      <button class="btn-info" (click)="toggleStats()">
        {{ showStats ? 'ğŸ“‰ Sakrij Statistike' : 'ğŸ“ˆ PrikaÅ¾i Statistike' }}
      </button>
      <button class="btn-success" (click)="exportCSV()" [disabled]="data.length === 0">
        ğŸ’¾ Export CSV
      </button>
    </div>

    <div class="filters">
      <div class="filter-group">
        <label for="filterNaziv">Filter po nazivu:</label>
        <input 
          type="text" 
          id="filterNaziv"
          [(ngModel)]="filterNaziv" 
          placeholder="Unesite naziv..."
          (keyup.enter)="loadData()"
        />
      </div>
      
      <div class="filter-group">
        <label for="filterGrad">Filter po gradu:</label>
        <input 
          type="text" 
          id="filterGrad"
          [(ngModel)]="filterGrad" 
          placeholder="Unesite grad..."
          (keyup.enter)="loadData()"
        />
      </div>
      
      <button class="btn-warning" (click)="clearFilters()" [disabled]="loading">
        ğŸ”„ OÄisti Filtere
      </button>
    </div>
  </div>

  <!-- Statistike -->
  <div class="stats-section" *ngIf="showStats && stats">
    <h2>ğŸ“Š Statistike</h2>
    <div class="stats-grid">
      <div class="stat-card">
        <div class="stat-value">{{ stats.stats.totalRecords }}</div>
        <div class="stat-label">Ukupno zapisa</div>
      </div>
      <div class="stat-card">
        <div class="stat-value">{{ stats.stats.avgCijena | number:'1.2-2' }}â‚¬</div>
        <div class="stat-label">ProsjeÄna cijena</div>
      </div>
      <div class="stat-card">
        <div class="stat-value">{{ stats.stats.minCijena | number:'1.2-2' }}â‚¬</div>
        <div class="stat-label">Min cijena</div>
      </div>
      <div class="stat-card">
        <div class="stat-value">{{ stats.stats.maxCijena | number:'1.2-2' }}â‚¬</div>
        <div class="stat-label">Max cijena</div>
      </div>
      <div class="stat-card">
        <div class="stat-value">{{ stats.stats.uniqueGradovi }}</div>
        <div class="stat-label">Gradova</div>
      </div>
      <div class="stat-card">
        <div class="stat-value">{{ stats.stats.uniqueNazivi }}</div>
        <div class="stat-label">Trgovina</div>
      </div>
    </div>
    
    <div class="available-dates" *ngIf="availableDates.length > 0">
      <h3>ğŸ“… Dostupni datumi spremljenih podataka:</h3>
      <div class="dates-list">
        <span class="date-badge" *ngFor="let date of availableDates">{{ date }}</span>
      </div>
    </div>
  </div>

  <div class="alert alert-success" *ngIf="message">
    âœ… {{ message }}
  </div>

  <div class="alert alert-error" *ngIf="error">
    âŒ {{ error }}
  </div>

  <div class="loading" *ngIf="loading">
    â³ UÄitavanje podataka...
  </div>

  <div class="data-section" *ngIf="!loading">
    <h2>ğŸ“‹ Podaci ({{ data.length }} zapisa)</h2>
    
    <div class="no-data" *ngIf="data.length === 0">
      Nema dostupnih podataka. Harvester Ä‡e automatski dohvatiti podatke.
    </div>

    <table *ngIf="data.length > 0">
      <thead>
        <tr>
          <th>ID</th>
          <th>Naziv</th>
          <th>Grad</th>
          <th>Kategorija</th>
          <th>Cijena (â‚¬)</th>
          <th>Datum</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let item of data">
          <td>{{ item.id }}</td>
          <td>{{ item.naziv }}</td>
          <td>{{ item.grad }}</td>
          <td>{{ item.kategorija }}</td>
          <td>{{ item.cijena | number:'1.2-2' }}</td>
          <td>{{ item.datum ? (item.datum | date:'short') : '-' }}</td>
        </tr>
      </tbody>
    </table>
  </div>
</div>
